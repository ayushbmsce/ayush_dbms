DROP DATABASE IF EXISTS supplierdb;
CREATE DATABASE supplierdb;
USE supplierdb;


CREATE TABLE Supplier (
    sid INT PRIMARY KEY,
    sname VARCHAR(50),
    city VARCHAR(50)
);

CREATE TABLE Parts (
    pid INT PRIMARY KEY,
    pname VARCHAR(50),
    color VARCHAR(20)
);

CREATE TABLE Catalog (
    sid INT,
    pid INT,
    cost DECIMAL(10,2),
    PRIMARY KEY (sid, pid),
    FOREIGN KEY (sid) REFERENCES Supplier(sid),
    FOREIGN KEY (pid) REFERENCES Parts(pid)
);


INSERT INTO Supplier VALUES
(1, 'Acme Widget Suppliers', 'Bangalore'),
(2, 'Global Parts Co', 'Delhi'),
(3, 'Prime Supplies', 'Mumbai');

INSERT INTO Parts VALUES
(101, 'Bolt', 'red'),
(102, 'Nut', 'blue'),
(103, 'Screw', 'red'),
(104, 'Washer', 'green');

INSERT INTO Catalog VALUES
(1, 101, 15.50),
(1, 102, 10.00),
(1, 103, 25.00),
(2, 101, 17.00),
(2, 104, 5.00),
(3, 102, 8.00),
(3, 103, 30.00);




SELECT DISTINCT p.pname
FROM Parts p
JOIN Catalog c ON p.pid = c.pid;


SELECT s.sname
FROM Supplier s
WHERE NOT EXISTS (
    SELECT * FROM Parts p
    WHERE NOT EXISTS (
        SELECT * FROM Catalog c
        WHERE c.sid = s.sid AND c.pid = p.pid
    )
);


SELECT s.sname
FROM Supplier s
WHERE NOT EXISTS (
    SELECT * FROM Parts p
    WHERE p.color = 'red'
    AND NOT EXISTS (
        SELECT * FROM Catalog c
        WHERE c.sid = s.sid AND c.pid = p.pid
    )
);


SELECT p.pname
FROM Parts p
JOIN Catalog c1 ON p.pid = c1.pid
JOIN Supplier s ON s.sid = c1.sid
WHERE s.sname = 'Acme Widget Suppliers'
AND NOT EXISTS (
    SELECT * FROM Catalog c2
    WHERE c2.pid = p.pid AND c2.sid <> s.sid
);


SELECT DISTINCT c.sid
FROM Catalog c
JOIN (
    SELECT pid, AVG(cost) AS avg_cost
    FROM Catalog
    GROUP BY pid
) avgc
ON c.pid = avgc.pid
WHERE c.cost > avgc.avg_cost;

SELECT p.pname, s.sname, c.cost
FROM Parts p
JOIN Catalog c ON p.pid = c.pid
JOIN Supplier s ON s.sid = c.sid
WHERE c.cost = (
    SELECT MAX(c2.cost)
    FROM Catalog c2
    WHERE c2.pid = p.pid







);
